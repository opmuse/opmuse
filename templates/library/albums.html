{% extends "body.html" %}

{% block title  %}
    Library - Albums
{% endblock %}

{% block navbar_sub %}
    {% include "partials/library-nav.html" %}
{% endblock %}

{% block content %}
    {% import "macros/album.html" as album_macros %}
    {% import "macros/urls.html" as urls %}
    {% import "macros/pagination.html" as pagination %}
    {% import "macros/covers.html" as covers %}

    <div id="library">
        <dl class="filters">
            <dt>Filter</dt>
            <dd>
                <ul>
                    <li class="{{ "active" if filter == "none" else "" }}">
                        <a href="/library/albums?view={{ view }}&filter=none&sort={{ sort }}">
                            <i class="icon-circle-blank"></i>
                            None
                        </a>
                    </li>
                    <li class="{{ "active" if filter == "6or30" else "" }}">
                        <a href="/library/albums?view={{ view }}&filter=6or30&sort={{ sort }}"
                            title="Albums that have more than 6 tracks or are more than 30 minutes long.">
                            <i class="icon-music"></i>
                            &gt;6 or &gt;30m
                        </a>
                    </li>
                    <li class="{{ "active" if filter == "yours" else "" }}">
                        <a href="/library/albums?view={{ view }}&filter=yours&sort={{ sort }}">
                            <i class="icon-user"></i>
                            Yours
                        </a>
                    </li>
                    <li class="{{ "active" if filter == "va" else "" }}">
                        <a href="/library/albums?view={{ view }}&filter=va&sort={{ sort }}">
                            <i class="icon-circle"></i>
                            VA
                        </a>
                    </li>
                    <li class="{{ "active" if filter == "invalid" else "" }}">
                        <a href="/library/albums?view={{ view }}&filter=invalid&sort={{ sort }}">
                            <i class="icon-warning-sign"></i>
                            Invalid
                        </a>
                    </li>
                </ul>
            </dd>
        </dl>
        <dl class="sorts">
            <dt>Sort</dt>
            <dd>
                <ul>
                    <li class="{{ "active" if sort == "none" else "" }}">
                        <a href="/library/albums?view={{ view }}&filter={{ filter }}&sort=none">
                            <i class="icon-circle-blank"></i>
                            None
                        </a>
                    </li>
                    <li class="{{ "active" if sort == "added" else "" }}">
                        <a href="/library/albums?view={{ view }}&filter={{ filter }}&sort=added">
                            <i class="icon-asterisk"></i>
                            Added
                        </a>
                    </li>
                    <li class="{{ "active" if sort == "date" else "" }}">
                        <a href="/library/albums?view={{ view }}&filter={{ filter }}&sort=date">
                            <i class="icon-calendar"></i>
                            Date
                        </a>
                    </li>
                    <li class="{{ "active" if sort == "random" else "" }}">
                        <a href="/library/albums?view={{ view }}&filter={{ filter }}&sort=random">
                            <i class="icon-random"></i>
                            Random
                        </a>
                    </li>
                </ul>
            </dd>
        </dl>
        <dl class="views">
            <dt>View</dt>
            <dd>
                <ul>
                    <li class="{{ "active" if view == "covers" else "" }}">
                        <a href="/library/albums?view=covers&filter={{ filter }}&sort={{ sort }}">
                            <i class="icon-th-large"></i>
                            Covers
                        </a>
                    </li>
                    <li class="{{ "active" if view == "list" else "" }}">
                        <a href="/library/albums?view=list&filter={{ filter }}&sort={{ sort }}">
                            <i class="icon-list-ul"></i>
                            List
                        </a>
                    </li>
                </ul>
            </dd>
        </dl>

        {% if view == "covers" %}
            <hr />
        {% endif %}

        <div class="albums">
            {% if view == "covers" %}
                {% for album in albums %}
                    {{ album_macros.album(None, album) }}
                {% endfor %}
            {% elif view == "list" %}
                <table class="table table-striped table-bordered album-list table-condensed">
                    <thead>
                        <tr>
                            <th>&nbsp;</th>
                            <th>&nbsp;</th>
                            <th>Name</th>
                            <th>Artist(s)</th>
                            <th>Date</th>
                            <th>Tracks</th>
                            <th>Duration</th>
                            <th>Added</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for album in albums %}
                            {% set album_url = urls.album_url(album, artist) %}
                            <tr>
                                <td class="cover">
                                    <a href="{{ album_url }}">
                                        {{ covers.album(album, 40, "img-rounded") }}
                                    </a>
                                </td>
                                <td class="queue">
                                    {{ album_macros.album_queue_btn(album) }}
                                </td>
                                <td>
                                    <a href="{{ album_url }}">
                                        {{ album.name }}
                                    </a>
                                </td>
                                <td>
                                    {{ album_macros.album_desc(album, true, false) }}
                                </td>
                                <td>
                                    {% if album.date %}
                                        {{ album.date }}
                                    {% endif %}
                                </td>
                                <td>
                                    {{ album.tracks|count }}
                                </td>
                                <td>
                                    {{ album.duration|format_seconds }}
                                </td>
                                <td class="added">
                                    {{ album.added|pretty_date }}
                                </td>
                            </tr>
                        {% endfor %}
                    </tbody>
                </table>
            {% endif %}
        </div>

        {% if page %}
            {% set url = "/library/albums?sort=" + sort + "&filter=" + filter + "&page=" %}
            {{ pagination.pagination(url, page, pages) }}
        {% endif %}
    </div>
{% endblock %}
