{% extends "body.html" %}
{% set subnav_file_path = "partials/library-nav.html" %}

{% block title  %}
    Library - Albums
{% endblock %}

{% block content %}
    {% import "macros/album.html" as album_macros %}
    {% import "macros/urls.html" as urls %}
    {% import "macros/pagination.html" as pagination %}
    {% import "macros/covers.html" as covers %}

    <div id="library">
        <dl class="filters">
            <dt>Filter</dt>
            <dd>
                <ul>
                    <li>
                        <a class="btn btn-xs {{ "btn-primary" if filter == "none" else "btn-default" }}" href="/library/albums?view={{ view }}&filter=none&sort={{ sort }}&filter_value={{ filter_value }}">
                            <i class="fa fa-circle-o"></i>
                            None
                        </a>
                    </li>
                    <li>
                        <a class="btn btn-xs {{ "btn-primary" if filter == "6or30" else "btn-default" }}" href="/library/albums?view={{ view }}&filter=6or30&sort={{ sort }}&filter_value={{ filter_value }}"
                            title="Albums that have more than 6 tracks or are more than 30 minutes long.">
                            <i class="fa fa-music"></i>
                            &gt;6 or &gt;30m
                        </a>
                    </li>
                    <li>
                        <a class="btn btn-xs {{ "btn-primary" if filter == "yours" else "btn-default" }}" href="/library/albums?view={{ view }}&filter=yours&sort={{ sort }}&filter_value={{ filter_value }}">
                            <i class="fa fa-user"></i>
                            Yours
                        </a>
                    </li>
                    <li>
                        <a class="btn btn-xs {{ "btn-primary" if filter == "va" else "btn-default" }}" href="/library/albums?view={{ view }}&filter=va&sort={{ sort }}&filter_value={{ filter_value }}">
                            <i class="fa fa-circle"></i>
                            VA
                        </a>
                    </li>
                    <li>
                        <a class="btn btn-xs {{ "btn-primary" if filter == "invalid" else "btn-default" }}" href="/library/albums?view={{ view }}&filter=invalid&sort={{ sort }}&filter_value={{ filter_value }}">
                            <i class="fa fa-exclamation-triangle"></i>
                            Invalid
                        </a>
                    </li>
                    <li class="filter_value ">
                        <a class="btn btn-xs {{ "btn-primary" if filter == "tag" else "btn-default" }}" href="/library/albums?view={{ view }}&filter=tag&sort={{ sort }}">
                            <i class="fa fa-tag"></i>
                            <input autocomplete="off" type="text" class="form-control"
                                placeholder="Tag" value="{{ filter_value }}" />
                        </a>
                    </li>
                </ul>
            </dd>
        </dl>
        <dl class="sorts">
            <dt>Sort</dt>
            <dd>
                <ul>
                    <li>
                        <a class="btn btn-xs {{ "btn-primary" if sort == "none" else "btn-default" }}" href="/library/albums?view={{ view }}&filter={{ filter }}&sort=none&filter_value={{ filter_value }}">
                            <i class="fa fa-circle-o"></i>
                            None
                        </a>
                    </li>
                    <li>
                        <a class="btn btn-xs {{ "btn-primary" if sort == "added" else "btn-default" }}" href="/library/albums?view={{ view }}&filter={{ filter }}&sort=added&filter_value={{ filter_value }}">
                            <i class="fa fa-asterisk"></i>
                            Added
                        </a>
                    </li>
                    <li>
                        <a class="btn btn-xs {{ "btn-primary" if sort == "date" else "btn-default" }}" href="/library/albums?view={{ view }}&filter={{ filter }}&sort=date&filter_value={{ filter_value }}">
                            <i class="fa fa-calendar"></i>
                            Date
                        </a>
                    </li>
                    <li>
                        <a class="btn btn-xs {{ "btn-primary" if sort == "random" else "btn-default" }}" href="/library/albums?view={{ view }}&filter={{ filter }}&sort=random&filter_value={{ filter_value }}">
                            <i class="fa fa-random"></i>
                            Random
                        </a>
                    </li>
                </ul>
            </dd>
        </dl>
        <dl class="views">
            <dt>View</dt>
            <dd>
                <ul>
                    <li>
                        <a class="btn btn-xs {{ "btn-primary" if view == "covers" else "btn-default" }}" href="/library/albums?view=covers&filter={{ filter }}&sort={{ sort }}&filter_value={{ filter_value }}">
                            <i class="fa fa-th-large"></i>
                            Covers
                        </a>
                    </li>
                    <li>
                        <a class="btn btn-xs {{ "btn-primary" if view == "list" else "btn-default" }}" href="/library/albums?view=list&filter={{ filter }}&sort={{ sort }}&filter_value={{ filter_value }}">
                            <i class="fa fa-list-ul"></i>
                            List
                        </a>
                    </li>
                </ul>
            </dd>
        </dl>

        {% if view == "covers" %}
            <hr />
        {% endif %}

        <div class="albums remotes" data-remotes-tag="{{ filter_value if filter == "tag" else "" }}">
            {% if filter == "tag" and albums|length == 0 %}
                <p class="alert alert-info">
                    No albums found for tag <strong>{{ filter_value }}</strong>,
                    remote tag data might be being fetched.
                    Page will update automatically when done.
                </p>
            {% elif view == "covers" %}
                {% for album in albums %}
                    {{ album_macros.album(None, album) }}
                {% endfor %}
            {% elif view == "list" %}
                <table class="table table-striped table-bordered album-list table-condensed">
                    <tr>
                        <th>&nbsp;</th>
                        <th>&nbsp;</th>
                        <th>Name</th>
                        <th>Artist(s)</th>
                        <th>Date</th>
                        <th>Tracks</th>
                        <th>Duration</th>
                        <th>Added</th>
                    </tr>
                    {% for album in albums %}
                        {% set album_url = urls.album_url(album, artist) %}
                        <tr>
                            <td class="cover">
                                <a href="{{ album_url }}">
                                    {{ covers.album(album, 40, "img-rounded") }}
                                </a>
                            </td>
                            <td class="queue">
                                {{ album_macros.album_queue_btn(album) }}
                            </td>
                            <td>
                                <a href="{{ album_url }}">
                                    {{ album.name }}
                                </a>
                            </td>
                            <td>
                                {{ album_macros.album_desc(album, true, false) }}
                            </td>
                            <td>
                                {% if album.date %}
                                    {{ album.date }}
                                {% endif %}
                            </td>
                            <td>
                                {{ album.tracks|count }}
                            </td>
                            <td>
                                {{ album.duration|format_seconds }}
                            </td>
                            <td class="added">
                                {{ album.added|pretty_date }}
                            </td>
                        </tr>
                    {% endfor %}
                </table>
            {% endif %}
        </div>

        {% if page %}
            {% set url = "/library/albums?view=" + view + "&sort=" + sort + "&filter=" + filter + "&filter_value=" + filter_value + "&page=" %}
            {{ pagination.pagination(url, page, pages) }}
        {% endif %}
    </div>
{% endblock %}
