{% extends "body.html" %}

{% block title %}
    User - {{ user.login }}
{% endblock %}

{% block right %}
<div class="artist-nav well sidebar-nav">
    {% if remotes_user.lastfm %}
    <ul class="nav nav-list">
        <li class="nav-header">External pages</li>
        <li>
            <a href="{{ remotes_user.lastfm.url }}">Go to Lastfm user page</a>
        </li>
    </ul>
    {% endif %}
</div>
{% endblock %}

{% block content %}
<div id="users">
    {% include "partials/users-nav.html" %}

    <ul class="row-fluid">
        <li class="span11">
            <div class="media">
                <img class="pull-left media-object img-rounded" src="{{ user.gravatar_large }}" alt="{{ user.login }}'s Gravatar" />
                <div class="media-body">
                    <h4 class="media-heading">{{ user.login }}</h4>
                    <p>{{ user.mail }}</p>
                </div>
            </div>
        </li>
    </ul>

    <ul class="row-fluid">
        <li class="span5">
            {% if remotes_user.lastfm.top_artists_overall %}
                <table class="table table-striped table-bordered">
                    <tr>
                        <th colspan="3">Lastfm Top Artists</th>
                    </tr>
                    {% for artist in remotes_user.lastfm.top_artists_overall %}
                    <tr>
                        <td>{{ artist.index }}</td>
                        <td><a href="/search/{{ artist.name }}/artist">{{ artist.name|show_ws }}</a></td>
                        <td>{{ artist.weight|format_number }}</td>
                    </tr>
                    {% endfor %}
                </table>
            {% endif %}
        </li>
        <li class="span6">
            {% if remotes_user.lastfm %}
                <table class="table table-striped table-bordered">
                    <tr>
                        <th colspan="2">Lastfm Recent Tracks</th>
                    </tr>
                    {% for track in remotes_user.lastfm.recent_tracks %}
                    {% if not last_track or last_track.artist != track.artist %}
                    <tr>
                        <th colspan="2"><a href="/search/{{ track.artist }}/artist">{{ track.artist }}</a></th>
                    </tr>
                    {% endif %}
                    <tr>
                        <td>{{ track.timestamp|pretty_date }}</td>
                        <td><a href="/search/{{ track.name }}">{{ track.name|show_ws }}</a></td>
                    </tr>
                    {% set last_track = track %}
                    {% endfor %}
                </table>
            {% endif %}
        </li>
    </ul>
</div>
{% endblock %}

